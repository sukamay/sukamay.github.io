<hr>
<p>title: DjangoInUbuntu_1</p>
<h2 id="categories-Django"><a href="#categories-Django" class="headerlink" title="categories: Django"></a>categories: Django</h2><h1 id="Django-In-Ubuntu-part1"><a href="#Django-In-Ubuntu-part1" class="headerlink" title="Django In Ubuntu part1"></a>Django In Ubuntu part1</h1><h2 id="1-数据库配置"><a href="#1-数据库配置" class="headerlink" title="1. 数据库配置"></a>1. 数据库配置</h2><p>我们在项目的 settings.py 文件中找到 DATABASES 配置项，将其信息修改为：</p>
<h2 id="HelloWorld-HelloWorld-settings-py-文件代码："><a href="#HelloWorld-HelloWorld-settings-py-文件代码：" class="headerlink" title="HelloWorld/HelloWorld/settings.py: 文件代码："></a>HelloWorld/HelloWorld/settings.py: 文件代码：</h2><pre><code class="python">DATABASES = {     
    <span class="string">'default'</span>: {         
        <span class="string">'ENGINE'</span>: <span class="string">'django.db.backends.mysql'</span>,  
        <span class="comment"># 或者使用 mysql.connector.django         </span>
        <span class="string">'NAME'</span>: <span class="string">'test'</span>,         
        <span class="string">'USER'</span>: <span class="string">'test'</span>,         
        <span class="string">'PASSWORD'</span>: <span class="string">'test123'</span>,         
        <span class="string">'HOST'</span>:<span class="string">'localhost'</span>,         
        <span class="string">'PORT'</span>:<span class="string">'3306'</span>,     
    } 
}
</code></pre>
<p>这里添加了中文注释，所以你需要在 HelloWorld/settings.py 文件头部添加 <strong># -*- coding: UTF-8 -*-</strong>。</p>
<p>上面包含数据库名称和用户的信息，它们与 MySQL 中对应数据库和用户的设置相同。Django 根据这一设置，与 MySQL 中相应的数据库和用户连接起来</p>
<p><strong>Error:</strong> django.core.exceptions.ImproperlyConfigured: Error loading MySQLdb module: No module named MySQLdb.</p>
<p><strong>Solve:</strong>  python2.7 + Django1.11 , 解决方案： <code>pip install mysql-server</code></p>
<pre><code class="shell">root@iZwz969jm0y04abuhgx4byZ:~# pip install mysql-python
<span class="meta">#</span>随后验证一下是否安装成功
root@iZwz969jm0y04abuhgx4byZ:~# python
Python 2.7.12 (default, Nov 12 2018, 14:36:49) 
[GCC 5.4.0 20160609] on linux2
Type "help", "copyright", "credits" or "license" for more information.
<span class="meta">&gt;</span>&gt;&gt; import MYSQLdb
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ImportError: No module named MYSQLdb
<span class="meta">&gt;</span>&gt;&gt; import MySQLdb
<span class="meta">&gt;</span>&gt;&gt; exit()
</code></pre>
<h2 id="2-Django表单"><a href="#2-Django表单" class="headerlink" title="2. Django表单"></a>2. Django表单</h2><p>HTML表单是网站交互性的经典方式。 本章将介绍如何用Django对用户提交的表单数据进行处理。 </p>
<hr>
<h3 id="HTTP-请求"><a href="#HTTP-请求" class="headerlink" title="HTTP 请求"></a>HTTP 请求</h3><p>HTTP协议以”请求－回复”的方式工作。客户发送请求时，可以在请求中附加数据。服务器通过解析请求，就可以获得客户传来的数据，并根据URL来提供特定的服务。</p>
<h4 id="GET-方法"><a href="#GET-方法" class="headerlink" title="GET 方法"></a>GET 方法</h4><p>我们在之前的项目中创建一个 search.py 文件，用于接收用户的请求：</p>
<p>/HelloWorld/HelloWorld/search.py 文件代码：</p>
<pre><code class="python"><span class="comment"># -*- coding: utf-8 -*-</span>

<span class="keyword">from</span> django.http <span class="keyword">import</span> HttpResponse
<span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render_to_response

<span class="comment"># 表单</span>
<span class="function"><span class="keyword">def</span> <span class="title">search_form</span><span class="params">(request)</span>:</span>
    <span class="keyword">return</span> render_to_response(<span class="string">'search_form.html'</span>)

<span class="comment"># 接收请求数据</span>
<span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(request)</span>:</span>  
    request.encoding=<span class="string">'utf-8'</span>
    <span class="keyword">if</span> <span class="string">'q'</span> <span class="keyword">in</span> request.GET:
        message = <span class="string">'你搜索的内容为: '</span> + request.GET[<span class="string">'q'</span>]
    <span class="keyword">else</span>:
        message = <span class="string">'你提交了空表单'</span>
    <span class="keyword">return</span> HttpResponse(message)
</code></pre>
<p>在模板目录 templates 中添加 search_form.html 表单：</p>
<p>/HelloWorld/templates/search_form.html 文件代码：</p>
<p>&lt;!DOCTYPE html&gt;</p>
<html><br><head><meta name="generator" content="Hexo 3.8.0"><br><meta charset="utf-8"><br><title>菜鸟教程(runoob.com)</title><br></head><br><body><br>    <form action="/search" method="get"><br>        <input type="text" name="q"><br>        <input type="submit" value="搜索"><br>    </form><br></body><br></html>

<p>urls.py 规则修改为如下形式：</p>
<p>/HelloWorld/HelloWorld/urls.py 文件代码：</p>
<pre><code class="python"><span class="keyword">from</span> django.conf.urls <span class="keyword">import</span> url
<span class="keyword">from</span> . <span class="keyword">import</span> view,testdb,search

urlpatterns = [
    url(<span class="string">r'^hello$'</span>, view.hello),
    url(<span class="string">r'^testdb$'</span>, testdb.testdb),
    url(<span class="string">r'^search-form$'</span>, search.search_form),
    url(<span class="string">r'^search$'</span>, search.search),
]
</code></pre>
<p>访问地址 <a href="http://120.76.62.132:8000/search-form">http://120.76.62.132:8000/search-form</a> 并搜索</p>
<p><strong>Error:</strong> 在Django视图函数中经常出现类似于’ascii’ codec can’t decode byte 0xef in position 0:ordinal not in range(128)的错误。</p>
<p><strong>Solve:</strong> 使用同一套编码，将字符串全都转成byte string或unicode string</p>
<p>​      1.将字符串全都转成byte string。<br>​            self.response.out.write(“你好”+self.request.get(“argu”).encode(“utf-8”))<br>​        2.将字符串全都转成unicode string。<br>​           self.response.out.write(u”你好”+self.request.get(“argu”))<br>​            byte string转换成unicode string可以这样转unicode(unicodestring, “utf-8”)    </p>
<p><a href="https://blog.csdn.net/use_my_heart/article/details/51303317">python编码错误</a></p>
<p><strong>Error:</strong> django.db.utils.ProgrammingError: (1146, u”Table’’ doesn’t exist”)解决办法</p>
<p><strong>Slove:</strong>  原因：访问了数据库里不存在的表，可能是因为在model改变之后表结构没有更新</p>
<pre><code class="shell">root@iZwz969jm0y04abuhgx4byZ:~/HelloWorld# python manage.py migrate
root@iZwz969jm0y04abuhgx4byZ:~/HelloWorld# python manage.py makemigrations TestModel
Migrations for &#39;TestModel&#39;:
  TestModel/migrations/0002_contact_tag.py
    - Create model Contact
    - Create model Tag
root@iZwz969jm0y04abuhgx4byZ:~/HelloWorld# python manage.py migrate TestModel
</code></pre>
